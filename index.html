<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cetak Voucher Ruijie (Diperbaiki)</title><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');:root{--primary-color:#4a90e2;--secondary-color:#50e3c2;--danger-color:#e74c3c;--dark-color:#2c3e50;--light-color:#ffffff;--grey-color:#f0f2f5;--text-color:#34495e;--shadow:0 10px 20px rgba(0,0,0,0.1)}body{font-family:'Poppins',sans-serif;margin:0;background:linear-gradient(135deg,var(--grey-color),#e9ecef);color:var(--text-color);line-height:1.6}.container{max-width:1200px;margin:0 auto;padding:30px 20px}header h1{text-align:center;font-size:2.5em;font-weight:700;color:var(--dark-color);margin-bottom:25px}.controls{padding:25px;background:var(--light-color);border-radius:12px;box-shadow:var(--shadow);margin-bottom:40px;display:flex;flex-direction:column;gap:25px;align-items:center}.input-area{display:flex;gap:25px;flex-grow:1;justify-content:center;flex-wrap:wrap}.input-group{display:flex;flex-direction:column;gap:8px;align-items:center}.input-group label{font-weight:600;font-size:.9em;color:var(--text-color)}.btn{padding:12px 24px;border:none;border-radius:8px;cursor:pointer;font-size:1em;font-weight:600;transition:all .3s ease;text-decoration:none;display:inline-flex;align-items:center;gap:10px;box-shadow:0 4px 6px rgba(0,0,0,.1)}.btn-upload{background-color:#e9ecef;color:var(--dark-color)}.btn-upload:hover{background-color:#dde1e4}.actions-area{display:flex;gap:15px;align-items:center;flex-wrap:wrap;justify-content:center;width:100%}.btn-print{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));color:white}.btn-print:hover{transform:translateY(-2px);box-shadow:0 6px 12px rgba(74,144,226,.4)}.btn-danger{background-color:var(--danger-color);color:white}.btn-danger:hover{background-color:#c0392b;transform:translateY(-2px)}.btn-github{background-color:#333;color:white}.btn-github:hover{background-color:#555;transform:translateY(-2px)}#voucher-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}.voucher{border:1px solid #e0e0e0;padding:15px;background-color:var(--light-color);border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.08);display:flex;flex-direction:column;align-items:center;text-align:center;page-break-inside:avoid;transition:transform .3s ease,box-shadow .3s ease}.voucher:hover{transform:translateY(-5px);box-shadow:0 8px 16px rgba(0,0,0,.1)}.voucher-logo{max-width:120px;max-height:60px;margin-bottom:15px;object-fit:contain}.voucher-data p{font-size:.95em;margin:5px 0;width:100%}.voucher-data .label{font-weight:600;color:var(--text-color);display:block;font-size:.8em;text-transform:uppercase}.voucher-code{font-weight:700;font-size:1.2em;color:var(--primary-color);word-break:break-all}footer{text-align:center;margin-top:50px;padding:30px;border-top:1px solid #e0e0e0}.btn-trakteer{background-color:#ec4899;color:white}.btn-trakteer:hover{background-color:#db2777}.copyright{font-size:.9em;color:#7f8c8d;margin-top:15px}@media (max-width:768px){header h1{font-size:2em}.controls{justify-content:center}#voucher-container{grid-template-columns:1fr}.input-area,.actions-area{flex-direction:column;width:100%}.btn{width:100%;justify-content:center}}@media print{body{margin:0;background-color:var(--light-color)}.container{padding:0}header,.controls,footer{display:none}#voucher-container{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr;gap:2px;margin:2mm}.voucher{box-shadow:none;border:1px solid #000;padding:2px;border-radius:4px}.voucher-logo{max-height:35px;margin-bottom:2px}.voucher-data p{font-size:8pt;margin:1px 0}.voucher-code{font-size:9pt;color:#000!important}}</style></head><body><div class="container"><header><h1>Cetak Voucher Ruijie</h1></header><div class="controls"><div class="input-area"><div class="input-group"><label for="logoUpload">1. Unggah Logo</label><input type="file" id="logoUpload" accept="image/*" class="btn btn-upload"></div><div class="input-group"><label for="excelFile">2. Unggah Excel</label><input type="file" id="excelFile" accept=".xlsx" class="btn btn-upload"></div></div><div class="actions-area"><button id="clearButton" class="btn btn-danger">üóëÔ∏è Clear Vouchers</button><button id="printButton" class="btn btn-print">üñ®Ô∏è Cetak Voucher</button><a href="https://github.com/muhayyanhz" target="_blank" rel="noopener noreferrer" class="btn btn-github"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.43 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8"/></svg> GitHub</a></div></div><div id="voucher-container"></div><footer><a href="https://teer.id/muhayyanhz" target="_blank" rel="noopener noreferrer" class="btn btn-trakteer"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24" style="border-radius:50%;padding:1px;background:white;color:#D94A8A;"><path d="M19.382 4.137c-1.258-.236-2.617.158-4.058.452-1.385.282-2.348.43-3.088.43-.74 0-1.703-.148-3.088-.43-1.44-.294-2.8-.688-4.058-.452C.92 4.32.17 5.624.17 7.157c0 1.504.688 2.584.688 2.584s.83 1.865.83 3.518c0 2.05-1.238 3.42-1.238 3.42s-.687 1.099-.687 2.565c0 1.533.75 2.837 4.927 2.837h12c4.177 0 4.927-1.304 4.927-2.837 0-1.466-.688-2.565-.688-2.565s-1.238-1.37-1.238-3.42c0-1.653.83-3.518.83-3.518s.688-1.08.688-2.584c0-1.533-.75-2.837-4.927-2.837zM7.17 11.206c-1.156 0-2.094-.938-2.094-2.094s.938-2.094 2.094-2.094 2.094.938 2.094 2.094-.938 2.094-2.094 2.094zm9.66 0c-1.156 0-2.094-.938-2.094-2.094s.938-2.094 2.094-2.094 2.094.938 2.094 2.094-.938 2.094-2.094 2.094z"/></svg> Support on Trakteer</a><p class="copyright">&copy; 2025 muhayyanhz</p></footer></div><script>const v1=document.getElementById('logoUpload'),v2=document.getElementById('excelFile'),v3=document.getElementById('printButton'),v4=document.getElementById('clearButton'),v5=document.getElementById('voucher-container');let v6='';function f1(a){v5.innerHTML='',a.forEach(b=>{const c=b['Kode voucher'];if(!c)return;const d=document.createElement('div');d.className='voucher';let e='';v6&&(e=`<img src="${v6}" alt="Logo" class="voucher-logo">`),d.innerHTML=`${e}<div class="voucher-data"><p><span class="label">Kode Voucher</span><span class="voucher-code">${c}</span></p><p><span class="label">Harga:</span> ${b.Harga||'-'}</p><p><span class="label">Periode:</span> ${b.Periode||'-'}</p><p><span class="label">Batasan:</span> ${b['Batasan Unggah/Unduh']||'-'}</p></div>`,v5.appendChild(d)})}v1.addEventListener('change',a=>{const b=a.target.files[0];b&&(v6=URL.createObjectURL(b),v5.innerHTML!==''&&document.querySelectorAll('.voucher-logo').forEach(c=>{c.src=v6}),alert('Logo berhasil diunggah!'))}),v2.addEventListener('change',a=>{const b=a.target.files[0];if(b){const c=new FileReader;c.onload=function(d){const e=new Uint8Array(d.target.result),g=XLSX.read(e,{type:'array'}),h=g.SheetNames[0],i=g.Sheets[h],j=XLSX.utils.sheet_to_json(i,{defval:''});f1(j)},c.onerror=function(d){console.error('Error reading file:',d),alert('Gagal membaca file Excel.')},c.readAsArrayBuffer(b)}}),v3.addEventListener('click',()=>{if(v5.innerHTML==='')return alert('Silakan unggah file Excel terlebih dahulu untuk membuat voucher.');window.print()}),v4.addEventListener('click',()=>{if(v5.innerHTML==='')return alert('Tidak ada voucher untuk dihapus.');confirm('Apakah Anda yakin ingin menghapus semua voucher dari tampilan?')&&(v5.innerHTML='',v1.value='',v2.value='',v6='',alert('Voucher telah dihapus dari tampilan.'))});</script></body></html>
